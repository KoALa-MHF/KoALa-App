<div class="table-toolbar">
  <button
    pButton
    pRipple
    *ngIf="supportedActions.createSession"
    label="{{ 'SESSION.CREATE_SESSION_MENU_LABEL' | translate }}"
    icon="pi pi-plus-circle"
    data-cy="session-create-btn"
    (click)="onSessionCreate()"
    class="p-button-text menu-button"
    attr.aria-label="{{ 'SESSION.OVERVIEW.ACC.CREATE' | translate }}"
  ></button>

  <button
    *ngIf="supportedActions.copySession"
    label="{{ 'SESSION.DUPLICATE_SESSION_MENU_LABEL' | translate }}"
    icon="pi pi-clone"
    pButton
    pRipple
    (click)="onSessionCopy()"
    class="p-button-text menu-button"
    [disabled]="!this.selectedSession"
  ></button>

  <button
    *ngIf="supportedActions.enterSession"
    label="{{ 'SESSION.ENTER_SESSION_MENU_LABEL' | translate }}"
    icon="pi pi-arrow-circle-right"
    pButton
    pRipple
    (click)="onSessionEnter()"
    class="p-button-text menu-button"
    [disabled]="!this.selectedSession"
  ></button>
</div>

<p-table
  selectionMode="single"
  [value]="sessions"
  class="mat-elevation-z8"
  data-cy="session-overview-table"
  [(selection)]="selectedSession"
>
  <ng-template pTemplate="header">
    <tr>
      <th id="SessionOverviewTableHeaderNameColumn">
        {{ 'SESSION.OVERVIEW.TABLE_HEADER.NAME_COL_LABEL' | translate }}
      </th>
      <th id="SessionOverviewTableHeaderCreationDateColumn">
        {{ 'SESSION.OVERVIEW.TABLE_HEADER.CREATION_DATE_COL_LABEL' | translate }}
      </th>
      <th id="SessionOverviewTableHeaderParticipantsColumn">
        {{ 'SESSION.OVERVIEW.TABLE_HEADER.PARTICIPANTS_COL_LABEL' | translate }}
      </th>
      <th id="SessionOverviewTableHeaderLastChangedDateColumn">
        {{ 'SESSION.OVERVIEW.TABLE_HEADER.CHANGED_DATE_COL_LABEL' | translate }}
      </th>
      <th id="SessionOverviewTableHeaderSettingsColumn" *ngIf="supportedActions.updateSession">
        {{ 'SESSION.OVERVIEW.TABLE_HEADER.SETTINGS_COL_LABEL' | translate }}
      </th>
      <th id="SessionOverviewTableHeaderLinkColumn" *ngIf="supportedActions.displaySessionCode">
        {{ 'SESSION.OVERVIEW.TABLE_HEADER.LINK_COL_LABEL' | translate }}
      </th>
      <th id="SessionOverviewTableHeaderExportColumn" *ngIf="supportedActions.exportSession">
        {{ 'SESSION.OVERVIEW.TABLE_HEADER.EXPORT_COL_LABEL' | translate }}
      </th>
      <th id="SessionOverviewTableHeaderDeleteColumn" *ngIf="supportedActions.deleteSession">
        {{ 'SESSION.OVERVIEW.TABLE_HEADER.DELETE_COL_LABEL' | translate }}
      </th>
    </tr>
  </ng-template>

  <ng-template pTemplate="body" let-session>
    <tr [pSelectableRow]="session">
      <td data-column="sessionName" data-cy="session-overview-name-col">{{ session.name }}</td>
      <td data-column="createdAt" data-cy="session-overview-created-at-col">
        {{ session.createdAt | date: 'medium' }}
      </td>
      <td data-column="participants" data-cy="session-overview-participants-col">
        {{ session.userSessions?.length || 0 }}
      </td>
      <td data-column="updatedAt" data-cy="session-overview-updated-at-col">
        {{ session.updatedAt | date: 'medium' }}
      </td>
      <td *ngIf="supportedActions.updateSession">
        <button
          pButton
          pRipple
          data-column="settings"
          aria-labelledby="SessionOverviewTableHeaderSettingsColumn"
          (click)="onSettings(session)"
          class="p-button-text"
          icon="pi pi-cog"
          data-cy="session-overview-settings-btn"
        ></button>
      </td>
      <td *ngIf="supportedActions.displaySessionCode">
        <button
          pButton
          pRipple
          data-column="qrCode"
          icon="pi pi-qrcode"
          class="p-button-text"
          aria-labelledby="SessionOverviewTableHeaderLinkColumn"
          (click)="onCodePressed(session)"
          data-cy="session-overview-qrcode-btn"
        ></button>
      </td>
      <td *ngIf="supportedActions.exportSession">
        <button
          pButton
          pRipple
          data-column="export"
          icon="pi pi-file-export"
          class="p-button-text"
          aria-labelledby="SessionOverviewTableHeaderExportColumn"
          (click)="onExport(session)"
          data-cy="session-overview-export-btn"
        ></button>
      </td>
      <td *ngIf="supportedActions.deleteSession">
        <button
          pButton
          pRipple
          data-column="delete"
          name="deleteButton"
          icon="pi pi-trash"
          class="p-button-text"
          aria-labelledby="SessionOverviewTableHeaderDeleteColumn"
          (click)="onSessionDelete(session)"
          data-cy="session-overview-delete-btn"
        ></button>
      </td>
    </tr>
  </ng-template>
</p-table>
